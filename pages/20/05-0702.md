---
layout: page
group: 20
level: 1
title: 7.2  Complex types
---

Complex types describe properties that are either JSON objects or containers of objects and properties. 
The $item property of a complex type is a JSON object of the type that comprises the metadata 
(including the type) for the contained object.  The $item property MUST be present for all complex 
types.

## <a name="sdata-choice">7.2.1  sdata/choice</a>

The sdata/choice type describes an enumeration.  The $item property MUST contain a $type and a 
$enum property.  The $enum property is an array of JSON objects delivering the enumeration elements. 
Each JSON object in $enum MUST contain a $value property which defines the value of the enumeration 
elements.

Example:   The property status taking on values "ready", "pending" or "done" would be expressed as:

<pre>
{ 
    "status" : {
        "$type" : "sdata/choice",
        "$item" : {
            "$type" : "sdata/string",
            "$enum" : [
                { "$value" : "ready", "$title" : "READY" }, 
                { "$value" : "pending", "$title" : "PENDING" }, 
                { "$value" : "done", "$title" : "DONE" } 
            ] 
        }
    }
}
</pre>

The payload for a valid resource could look like:

<pre>
{
    "status" : "ready"
}
</pre>

## <a name="sdata-array">7.2.2  sdata/array</a>

The sdata/array type specifies that the property is a JSON array.  The elements of the array are 
specified within $item and can be of any type.  The $item property MUST be present.

Example:   A simple object containing an array of tags can be expressed as:

<pre>
{
    "firstName": { "$type": "sdata/string" },
    "lastName": { "$type": "sdata/string" },
    "...": "...",
    "tags": {
        "$type": "sdata/array",
        "$item": {
            "type": "sdata/string"
        }
    }
}
</pre>

A valid resource payload could look like:
<pre>
{
    "firstName": "John",
    "lastName": "Doe",
    "...": "...",
    "tags": [ "C#", "Java", "Programming" ] 
}
</pre>

## <a name="sdata-reference">7.2.3  sdata/reference</a>

The sdata/reference type identifies a property that contains a reference to another SData resource.
The properties of the referenced resource MAY be included - fully or partially - in the payload.  These 
properties are to be viewed as **read-only**, and consequently any modification on the consumer side to 
these properties will be ignored by the provider. 

The metadata is presented as follows:

*  metadata pertaining to the property is defined within the object.
*  metadata pertaining to the sdata/reference object is defined within the $item object.

The referenced resource is pointed to by a $url specification located inside the $item block. The 
presence of:

*  $item is REQUIRED (in the object).
*  $url is REQUIRED (in the $item).
*  $properties is OPTIONAL.
*  $links is OPTIONAL but RECOMMENDED (see the next chapter for a discussion on links).

Example:   The manager of an Employee resource could be represented as follows:

<pre>
{
    "id": { "$type": "sdata/string" },
    "...": "...",
    "manager": {
        "$type": "sdata/reference",
        "$title": "Manager Link",
        "$key": "{$uuid}",
        "$item" : {
            "$url": "{$baseUrl}/users('{$key}')",
            "$title": "Manager Details",
            "$properties": {
                "firstName": { "$type": "sdata/string" },
                "lastName": { "$type": "sdata/string" }
            }
        }
    }  
}
</pre>

A valid resource payload could look like:

<pre>
{
    "id": "967-1111",
    "...": "...",
    "manager": {
        "firstName": "John",
        "lastName":  "Doe"
    }
}
</pre>

**IMPORTANT:**

A consumer can only operate on the relationship with the referenced resources. This means that 
relationships between enclosing and referenced resources can be created or deleted and then 
persisted via a PUT/PATCH on the enclosing resource.  It is not possible to create a new referenced 
resource in this context.  This is achieved by operating directly (via POST, DELETE) on the resource 
kind of the reference. [4](#4)

## <a name="sdata-object">7.2.4  sdata/object</a>

The sdata/object type identifies an embedded resource.  Please note that the payload of the 
embedded resource MUST be presented in its entirety within the payload of the enclosing resource.

The metadata is presented as follows:

*  metadata pertaining to the property is defined within the object.
*  metadata pertaining to the sdata/object is defined within the contained $item object.

The presence of:

*  $item is REQUIRED.
*  $url is OPTIONAL.
*  $properties is OPTIONAL.
*  $links is OPTIONAL but RECOMMENDED (see the next section for a discussion on links).

Example:   An Employee with an embedded Address resource could be represented as follows:

<pre>
{
    "firstName": { "$type": "sdata/string" },
    "lastName": { "$type": "sdata/string" },
    "...": "...",
    "address": {
        "$type": "sdata/object",
        "$title": "Address",
        "$item": {
            "$properties": {
                "street":  { "$type": "sdata/string" },
                "zip":   { "$type": "sdata/string" },
                "city":   { "$type": "sdata/string" },
                "state":   { "$type": "sdata/string" },
                "country": { "$type": "sdata/string", 
                "$format": "country"}
            }
        }
    }
}
</pre>

A valid resource payload could look like:

<pre>
{
    "firstName": "John",
    "lastName":  "Doe",
    "...": "...",
    "address": {
        "street":  "444 High Street",
        "zip":   "92301",
        "city":   "Palo Alto",
        "state":   "California",
        "country": "US"
    }
}
</pre>

**IMPORTANT:**

Unlike the sdata/reference case, the consumer can create, delete, and update the resources 
embedded as an sdata/object in the context of the object.  A PUT operation on a resource containing 
an sdata/object property will have the effect of persisting the resource **and** the embedded 
sdata/object resources as they stand (barring, of course, the case of constraint violations on the 
provider side). 


***
<a name="4">4</a>. Or by operating via the appropriate links: $create, $delete, $updateFull, $updatePartial as described in the next section.