---
layout: page
group: 20
level: 1
title: 2.2 Authorization Error Conditions
---

There are several authorization error conditions that the SData service MUST cater for:

## <a name="missing-access-token">2.2.1  Missing access token</a>

No access token was included with the request. 

In this case the SData service MUST return a HTTP 401 (unauthorized) status code with a WWWAuthenticate header but MUST NOT include any other error information: 
<pre>
HTTP/1.1 401 Unauthorized
WWW-Authenticate: Bearer realm="SageID"
</pre>

Note that the WWW-Authenticate header used in this and all other authorization error conditions MUST use the auth-scheme value "Bearer" and a realm of "SageID", as shown above.

## <a name="multiple-access-tokens">2.2.2  Multiple access tokens</a>

More than one access token was included with the request.

In this case the SData service MUST return a HTTP 401 (unauthorized) status code with a WWWAuthenticate header with an error parameter of "invalid_request" and an error_description parameter 
with a textual description of the cause of the error:

<pre>
HTTP/1.1 401 Unauthorized 
WWW-Authenticate: Bearer realm="SageID",error="invalid_request", error_description="Multiple access tokens were supplied."
</pre>

## <a name="invalid-access-token">2.2.3  Invalid access token</a>

An access token was included correctly with the request, but the provided token is malformed, expired 
or invalid for other reasons.

In this case the SData service MUST return a HTTP 401 (unauthorized) error code and a WWWAuthenticate header with an error parameter of "invalid_token" and an error_description parameter with a textual description of the cause of the error:

<pre>
HTTP/1.1 401 Unauthorized   
WWW-Authenticate: Bearer realm="SageID",   
error="invalid_token", error_description="The access token was expired."
</pre>

The error_description parameter MUST NOT include detailed technical information about the cause of 
the error which might allow a malicious user to ascertain details of the underlying implementation or to 
conduct attacks against the cryptography used to decrypt and validate the access token. It is 
RECOMMENDED that, if the token is invalid for any reason other than expiry, the error_description 
parameter should simply state that the access token was malformed.

## <a name="access-token-insufficient-scope">2.2.4  Access token with insufficient scope</a>

The provided access token is valid but the request requires higher privileges than encoded in the access 
token. 

In this case the SData service MUST return a HTTP 401 (unauthorized) error code and a WWWAuthenticate header with an error parameter of "insufficient_scope" and an error_description 
parameter with a textual description of the cause of the error:

<pre>
HTTP/1.1 401 Unauthorized   
WWW-Authenticate: Bearer realm="SageID",   
error="insufficient_scope", error_description="The access   
token did not contain the required permissions."
</pre>

**Note:**   
Use of the "scope" parameter is not covered in the SData Protocol's integration with Sage ID. According 
to [[3](../06-0300/#3)] and [[4](../06-0300/#4)], values of the scope parameter are defined by the authorization service (Sage ID in this 
case), rather than by the resource owner.


***